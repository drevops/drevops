networks:
  amazeeio-network:
    external: true
    name: amazeeio-network
services:
  chrome:
    depends_on:
      cli:
        condition: service_started
    environment:
      CI: "true"
      DREVOPS_PROJECT: your_site
      DRUPAL_SHIELD_PASS: ''
      DRUPAL_SHIELD_USER: ''
      LAGOON_ENVIRONMENT_TYPE: local
      LAGOON_LOCALDEV_URL: your-site.docker.amazee.io
      LAGOON_PROJECT: your_site
      LAGOON_ROUTE: your-site.docker.amazee.io
      XDEBUG_ENABLE: ''
    image: selenium/standalone-chrome:4.5.2-20221021
    labels:
      lagoon.type: none
    shm_size: 1gb
    volumes:
      - app:/app:rw
      - files:/app/web/sites/default/files:rw
  cli:
    build:
      args:
        WEBROOT: web
      context: FIXTURE_CUR_DIR
      dockerfile: .docker/cli.dockerfile
    environment:
      CI: "true"
      DREVOPS_PROJECT: your_site
      DRUPAL_SHIELD_PASS: ''
      DRUPAL_SHIELD_USER: ''
      LAGOON_ENVIRONMENT_TYPE: local
      LAGOON_LOCALDEV_URL: your-site.docker.amazee.io
      LAGOON_PROJECT: your_site
      LAGOON_ROUTE: your-site.docker.amazee.io
      XDEBUG_ENABLE: ''
    image: your_site-cli
    labels:
      lagoon.persistent: /app/web/sites/default/files/
      lagoon.persistent.name: nginx-php
      lagoon.type: cli-persistent
    ports:
      - target: 35729
    user: root
    volumes:
      - app:/app:rw
      - files:/app/web/sites/default/files:rw
  mariadb:
    build:
      args:
        IMAGE: uselagoon/mariadb-drupal:23.2.0
      context: FIXTURE_CUR_DIR
      dockerfile: .docker/mariadb.dockerfile
    environment:
      CI: "true"
      DREVOPS_PROJECT: your_site
      DRUPAL_SHIELD_PASS: ''
      DRUPAL_SHIELD_USER: ''
      LAGOON_ENVIRONMENT_TYPE: local
      LAGOON_LOCALDEV_URL: your-site.docker.amazee.io
      LAGOON_PROJECT: your_site
      LAGOON_ROUTE: your-site.docker.amazee.io
      XDEBUG_ENABLE: ''
    labels:
      lagoon.type: mariadb
    ports:
      - target: 3306
  nginx:
    build:
      args:
        CLI_IMAGE: your_site-cli
        WEBROOT: web
      context: FIXTURE_CUR_DIR
      dockerfile: .docker/nginx-drupal.dockerfile
    depends_on:
      cli:
        condition: service_started
    environment:
      CI: "true"
      DREVOPS_PROJECT: your_site
      DRUPAL_SHIELD_PASS: ''
      DRUPAL_SHIELD_USER: ''
      LAGOON_ENVIRONMENT_TYPE: local
      LAGOON_LOCALDEV_URL: your-site.docker.amazee.io
      LAGOON_PROJECT: your_site
      LAGOON_ROUTE: your-site.docker.amazee.io
      XDEBUG_ENABLE: ''
    labels:
      lagoon.name: nginx-php
      lagoon.persistent: /app/web/sites/default/files/
      lagoon.persistent.class: slow
      lagoon.type: nginx-php-persistent
    networks:
      amazeeio-network: null
      default: null
    user: '1000'
    volumes:
      - app:/app:rw
      - files:/app/web/sites/default/files:rw
  php:
    build:
      args:
        CLI_IMAGE: your_site-cli
      context: FIXTURE_CUR_DIR
      dockerfile: .docker/php.dockerfile
    depends_on:
      cli:
        condition: service_started
    environment:
      CI: "true"
      DREVOPS_PROJECT: your_site
      DRUPAL_SHIELD_PASS: ''
      DRUPAL_SHIELD_USER: ''
      LAGOON_ENVIRONMENT_TYPE: local
      LAGOON_LOCALDEV_URL: your-site.docker.amazee.io
      LAGOON_PROJECT: your_site
      LAGOON_ROUTE: your-site.docker.amazee.io
      XDEBUG_ENABLE: ''
    labels:
      lagoon.name: nginx-php
      lagoon.persistent: /app/web/sites/default/files/
      lagoon.persistent.class: slow
      lagoon.type: nginx-php-persistent
    user: '1000'
    volumes:
      - app:/app:rw
      - files:/app/web/sites/default/files:rw
  redis:
    image: uselagoon/redis-6:23.2.0
    labels:
      lagoon.type: redis
  solr:
    build:
      args:
        CLI_IMAGE: your_site-cli
      context: FIXTURE_CUR_DIR
      dockerfile: .docker/solr.dockerfile
    environment:
      CI: "true"
      DREVOPS_PROJECT: your_site
      DRUPAL_SHIELD_PASS: ''
      DRUPAL_SHIELD_USER: ''
      LAGOON_ENVIRONMENT_TYPE: local
      LAGOON_LOCALDEV_URL: your-site.docker.amazee.io
      LAGOON_PROJECT: your_site
      LAGOON_ROUTE: your-site.docker.amazee.io
      XDEBUG_ENABLE: ''
    labels:
      lagoon.type: solr
    ports:
      - target: 8983
    user: '1000'
  wait_dependencies:
    command: mariadb:3306
    depends_on:
      cli:
        condition: service_started
      mariadb:
        condition: service_started
    image: dadarek/wait-for-dependencies
    labels:
      lagoon.type: none
version: '2.3'
volumes:
  app: {}
  files: {}

