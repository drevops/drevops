---
ahoyapi: v2

commands:

  lint:
    cmd: ahoy lint-scripts && ahoy lint-spelling && ahoy lint-dockerfiles

  lint-spelling:
    cmd: cd ../../.. && pwd && ./scripts/drevops/tests/lint.spelling.sh

  lint-scripts:
    cmd: cd ../../.. && pwd && ./scripts/drevops/tests/lint.scripts.sh

  lint-dockerfiles:
    cmd: cd ../../.. && pwd && ./scripts/drevops/tests/lint.dockerfiles.sh

  test:
    cmd: ahoy test-common && ahoy test-deployment && ahoy test-workflow

  test-common:
    cmd: cd ../../.. && ./scripts/drevops/tests/test.common.sh

  test-deployment:
    cmd: cd ../../.. && ./scripts/drevops/tests/test.deployment.sh

  test-workflow:
    cmd: cd ../../.. && ./scripts/drevops/tests/test.workflow.sh

  # If there are changes to the fixtures - this command will re-run twice reporting error the first time.
  update-fixtures:
    cmd: |
      cd ../../.. \
      && UPDATE_FIXTURES=1 bats scripts/drevops/tests/bats/docker-compose.bats \
      || UPDATE_FIXTURES=1 bats scripts/drevops/tests/bats/docker-compose.bats

